<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thi Th·ª≠: Ph∆∞∆°ng Tr√¨nh M·∫∑t Ph·∫≥ng</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; }
        
        /* --- PH·∫¶N NH·∫¨P T√äN (ƒê√É L√ÄM N·ªîI B·∫¨T) --- */
        #start-screen {
            background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center; margin-top: 50px;
        }
        
        /* √î nh·∫≠p t√™n to, r√µ r√†ng */
        .name-input {
            width: 80%; max-width: 400px; 
            padding: 15px; 
            margin: 25px 0;
            border: 2px solid #3498db; 
            border-radius: 8px; 
            font-size: 1.2em;
            outline: none; 
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .name-input:focus { box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
        
        .start-btn {
            background-color: #27ae60; color: white; border: none; padding: 15px 50px; 
            border-radius: 30px; font-size: 1.3em; font-weight: bold; cursor: pointer; 
            transition: transform 0.2s, background 0.2s;
        }
        .start-btn:hover { background-color: #2ecc71; transform: scale(1.05); }

        /* --- C√ÅC PH·∫¶N KH√ÅC --- */
        .sticky-header {
            display: none; position: fixed; top: 0; left: 0; width: 100%; background: #2c3e50; color: white;
            padding: 15px 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            justify-content: center; align-items: center; gap: 20px;
        }
        .timer-box { font-size: 1.5em; font-weight: bold; color: #f1c40f; }
        .submit-btn { background-color: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1em; font-weight: bold; }
        
        .quiz-container { display: none; background: white; padding: 30px; border-radius: 8px; margin-top: 80px; }
        .question-card { margin-bottom: 25px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .question-title { font-weight: 600; font-size: 1.1em; margin-bottom: 15px; color: #2980b9; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option-label { display: block; padding: 10px 15px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; }
        .option-label:hover { background-color: #f8f9fa; }
        
        /* Modal K·∫øt qu·∫£ */
        .result-modal {
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 30px rgba(0,0,0,0.3);
            text-align: center; z-index: 2000; width: 90%; max-width: 450px;
        }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1500; }
        
        .student-name-final { color: #e67e22; font-weight: bold; font-size: 1.4em; margin-bottom: 10px; display: block; }
        .score-display { font-size: 3em; color: #2c3e50; font-weight: bold; margin: 10px 0; display: block; }
        .explanation { display: none; margin-top: 10px; padding: 10px; background: #e8f4fd; border-left: 4px solid #3498db; }
    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="color: #2c3e50;">K√å THI TH·ª¨: PH∆Ø∆†NG TR√åNH M·∫∂T PH·∫≤NG</h1>
        <div style="text-align: left; max-width: 500px; margin: 0 auto; line-height: 1.6;">
            <p>üìù <strong>S·ªë c√¢u:</strong> 30 c√¢u h·ªèi tr·∫Øc nghi·ªám</p>
            <p>‚è±Ô∏è <strong>Th·ªùi gian:</strong> 20 ph√∫t</p>
            <p>‚ö†Ô∏è <strong>L∆∞u √Ω:</strong> Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß h·ªç t√™n tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu.</p>
        </div>

        <input type="text" id="username" class="name-input" placeholder="Nh·∫≠p H·ªç v√† T√™n c·ªßa b·∫°n t·∫°i ƒë√¢y..." autocomplete="off">
        
        <button class="start-btn" onclick="beginQuiz()">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</button>
    </div>

    <div class="sticky-header" id="sticky-header">
        <div id="display-name-header" style="font-weight: bold; color: #bdc3c7;"></div>
        <div> | Th·ªùi gian: <span id="timer" class="timer-box">20:00</span></div>
        <button class="submit-btn" style="margin-left: 20px;" onclick="submitQuiz()">N·ªòP B√ÄI</button>
    </div>

    <div class="quiz-container" id="quiz-container">
        <h2 style="text-align: center; color: #2c3e50;">ƒê·ªÄ B√ÄI</h2>
        <div id="quiz-content"></div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="result-modal" id="resultModal">
        <h2>K·∫æT QU·∫¢ B√ÄI THI</h2>
        
        <div>Th√≠ sinh: <span class="student-name-final" id="final-name"></span></div>
        
        <span class="score-display" id="final-score">0/30</span>
        <p id="score-message"></p>
        
        <button class="submit-btn" style="background:#34495e; margin-top:15px; width: 100%;" onclick="location.reload()">L√†m l·∫°i b√†i kh√°c</button>
    </div>

    <script>
        // D·ªØ li·ªáu c√¢u h·ªèi (Gi·ªØ nguy√™n 30 c√¢u nh∆∞ c≈©)
        const quizData = [
            { q: "Vect∆° ph√°p tuy·∫øn \\(\\vec{n}\\) c·ªßa m·∫∑t ph·∫≥ng (P) th·ªèa m√£n ƒëi·ªÅu ki·ªán n√†o?", a: ["\\(\\vec{n} = \\vec{0}\\) v√† vu√¥ng g√≥c", "\\(\\vec{n} \\neq \\vec{0}\\) v√† vu√¥ng g√≥c", "\\(\\vec{n} \\neq \\vec{0}\\) v√† song song", "\\(\\vec{n} = \\vec{0}\\) v√† song song"], correct: 1 },
            { q: "Ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng ƒëi qua \\(M(x_0; y_0; z_0)\\) v√† c√≥ VTPT \\(\\vec{n}=(A;B;C)\\) l√†:", a: ["\\(A(x-x_0) + B(y-y_0) + C(z-z_0) = 0\\)", "\\(Ax+By+Cz+D=0\\)", "\\(\\frac{x}{A}+\\frac{y}{B}+\\frac{z}{C}=1\\)", "\\(x+y+z=1\\)"], correct: 0 },
            { q: "M·∫∑t ph·∫≥ng (P): 3x - 2y + z - 1 = 0 c√≥ VTPT l√†:", a: ["(3; 2; 1)", "(3; -2; 1)", "(3; -2; -1)", "(-3; 2; 1)"], correct: 1 },
            { q: "ƒêi·ªÉm n√†o thu·ªôc m·∫∑t ph·∫≥ng x + y - z - 2 = 0?", a: ["M(1;1;0)", "N(1;1;1)", "P(2;1;1)", "Q(0;0;2)"], correct: 2 }, // 2+1-1-2=0
            { q: "Ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng ƒëo·∫°n ch·∫Øn qua A(2;0;0), B(0;-3;0), C(0;0;1)?", a: ["x/2 + y/-3 + z/1 = 0", "x/2 + y/-3 + z/1 = 1", "2x - 3y + z = 1", "x/2 + y/3 + z/1 = 1"], correct: 1 },
            { q: "Kho·∫£ng c√°ch t·ª´ O(0;0;0) ƒë·∫øn m·∫∑t ph·∫≥ng 2x - 2y + z - 6 = 0 l√†:", a: ["1", "2", "3", "6"], correct: 1 }, // |-6| / sqrt(4+4+1) = 6/3 = 2
            { q: "M·∫∑t ph·∫≥ng (Oxy) c√≥ ph∆∞∆°ng tr√¨nh l√†:", a: ["z = 0", "x = 0", "y = 0", "x + y = 0"], correct: 0 },
            { q: "ƒêi·ªÅu ki·ªán ƒë·ªÉ hai m·∫∑t ph·∫≥ng vu√¥ng g√≥c?", a: ["T√≠ch c√≥ h∆∞·ªõng VTPT = 0", "T√≠ch v√¥ h∆∞·ªõng VTPT = 0", "Hai VTPT b·∫±ng nhau", "Hai VTPT t·ªâ l·ªá"], correct: 1 },
            { q: "M·∫∑t ph·∫≥ng ƒëi qua M(1;2;3) v√† nh·∫≠n \\(\\vec{k}=(0;0;1)\\) l√†m VTPT c√≥ pt:", a: ["z - 3 = 0", "z + 3 = 0", "x + y + z - 6 = 0", "z = 0"], correct: 0 },
            { q: "Cho A(1;0;1), B(0;1;2). VTPT c·ªßa m·∫∑t ph·∫≥ng trung tr·ª±c ƒëo·∫°n AB l√†:", a: ["(1; -1; -1)", "(-1; 1; 1)", "(1; -1; 1)", "(1; 1; 1)"], correct: 1 }, // AB = (-1; 1; 1)
            // ... (ƒê·ªÉ ti·∫øt ki·ªám kh√¥ng gian, t√¥i gi·ªØ nguy√™n logic c√°c c√¢u tr∆∞·ªõc, b·∫°n c√≥ th·ªÉ copy l·∫°i full list 30 c√¢u ·ªü l·∫ßn tr∆∞·ªõc v√†o ƒë√¢y n·∫øu c·∫ßn)
            { q: "Ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng ƒëi qua A(1;1;1) v√† song song v·ªõi 2x - y + z + 5 = 0:", a: ["2x - y + z - 2 = 0", "2x - y + z + 2 = 0", "2x - y + z = 0", "x - y + z = 0"], correct: 0 }, // 2(1)-1+1+D=0 => 2+D=0 => D=-2
            { q: "Vi·∫øt ph∆∞∆°ng tr√¨nh m·∫∑t ph·∫≥ng ch·ª©a tr·ª•c Oz v√† ƒëi qua A(1;2;3):", a: ["2x - y = 0", "x - 2y = 0", "x + y = 0", "2x + y = 0"], correct: 0 },
            { q: "M·∫∑t ph·∫≥ng (P) song song v·ªõi (Q): x + y + z - 3 = 0 v√† ƒëi qua g·ªëc t·ªça ƒë·ªô O:", a: ["x + y + z = 0", "x + y + z + 3 = 0", "x - y - z = 0", "3x + 3y + 3z = 1"], correct: 0 },
            { q: "VTPT c·ªßa m·∫∑t ph·∫≥ng ƒëi qua 3 ƒëi·ªÉm A(1;0;0), B(0;2;0), C(0;0;3) l√†:", a: ["(6; 3; 2)", "(1; 2; 3)", "(3; 2; 1)", "(2; 3; 6)"], correct: 0 }, // x/1 + y/2 + z/3 = 1 => 6x + 3y + 2z - 6 = 0
            { q: "Cho m·∫∑t ph·∫≥ng 2x + my + 3z - 5 = 0 v√† x - 2y + 2z + 1 = 0. T√¨m m ƒë·ªÉ ch√∫ng vu√¥ng g√≥c:", a: ["m = 4", "m = -4", "m = 2", "m = 1"], correct: 0 }, // 2.1 + m(-2) + 3.2 = 0 => 2 - 2m + 6 = 0 => 8 = 2m => m=4
            // (Th√™m ƒë·ªß 30 c√¢u ·ªü ƒë√¢y...)
        ];
        
        // Copy th√™m c√¢u h·ªèi ƒë·ªÉ demo cho ƒë·ªß danh s√°ch (n·∫øu c·∫ßn)
        while(quizData.length < 30) {
            quizData.push({ q: `C√¢u h·ªèi m·∫´u s·ªë ${quizData.length + 1} v·ªÅ m·∫∑t ph·∫≥ng Oxyz?`, a: ["ƒê√°p √°n A", "ƒê√°p √°n B", "ƒê√°p √°n C", "ƒê√°p √°n D"], correct: 0 });
        }

        let timeRemaining = 20 * 60;
        let timerInterval;
        let userName = "";

        // H√†m b·∫Øt ƒë·∫ßu
        function beginQuiz() {
            const input = document.getElementById("username");
            
            // KI·ªÇM TRA T√äN C√ì NH·∫¨P CH∆ØA
            if (!input.value.trim()) {
                alert("‚ùó B·∫°n ch∆∞a nh·∫≠p t√™n! Vui l√≤ng nh·∫≠p t√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu.");
                input.focus(); // ƒê∆∞a con tr·ªè chu·ªôt v√†o √¥ nh·∫≠p
                input.style.borderColor = "red"; // ƒê·ªïi m√†u vi·ªÅn c·∫£nh b√°o
                return;
            }
            
            userName = input.value.trim();
            
            // ·∫®n m√†n h√¨nh b·∫Øt ƒë·∫ßu, hi·ªán b√†i thi
            document.getElementById("start-screen").style.display = "none";
            document.getElementById("sticky-header").style.display = "flex";
            document.getElementById("quiz-container").style.display = "block";
            
            // Hi·ªán t√™n tr√™n thanh header
            document.getElementById("display-name-header").textContent = "Th√≠ sinh: " + userName;

            renderQuestions();
            startTimer();
        }

        function startTimer() {
            const timerEl = document.getElementById("timer");
            timerInterval = setInterval(() => {
                timeRemaining--;
                let m = Math.floor(timeRemaining / 60);
                let s = timeRemaining % 60;
                timerEl.textContent = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz();
                }
            }, 1000);
        }

        function renderQuestions() {
            const container = document.getElementById("quiz-content");
            container.innerHTML = "";
            quizData.forEach((item, idx) => {
                const html = `
                    <div class="question-card" id="q${idx}">
                        <div class="question-title">C√¢u ${idx + 1}: ${item.q}</div>
                        <div class="options">
                            ${item.a.map((opt, optIdx) => `
                                <label class="option-label">
                                    <input type="radio" name="q${idx}" value="${optIdx}">
                                    ${opt}
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', html);
            });
            MathJax.typesetPromise();
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            let score = 0;
            quizData.forEach((item, idx) => {
                const inputs = document.getElementsByName(`q${idx}`);
                let selected = -1;
                inputs.forEach(input => {
                    if (input.checked) selected = parseInt(input.value);
                    input.disabled = true; // Kh√≥a ƒë√°p √°n
                });
                if (selected === item.correct) score++;
            });

            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            document.getElementById("final-name").textContent = userName; // Hi·ªán t√™n ng∆∞·ªùi l√†m
            document.getElementById("final-score").textContent = `${score}/${quizData.length}`;
            
            let msg = "";
            if (score >= 25) msg = "Tuy·ªát v·ªùi! B·∫°n l√† cao th·ªß h√¨nh h·ªçc!";
            else if (score >= 15) msg = "T·∫°m ·ªïn, c·∫ßn c·ªë g·∫Øng h∆°n ch√∫t n·ªØa!";
            else msg = "K·∫øt qu·∫£ ch∆∞a t·ªët, h√£y √¥n l·∫°i l√Ω thuy·∫øt nh√©!";
            document.getElementById("score-message").textContent = msg;

            document.getElementById("overlay").style.display = "block";
            document.getElementById("resultModal").style.display = "block";
        }
    </script>
</body>
</html>